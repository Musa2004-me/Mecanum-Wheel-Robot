<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="new_robot">

  <!-- ================== ROS2 Control ================== -->
  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin>
    </hardware>

    
  <!-- <ros2_control name="RobotSystem" type="system">
    <hardware>
        <plugin>gz_ros2_control/GazeboSimSystem</plugin>
    </hardware>  -->

    <joint name="rear_right_wheel_joint">
      <!-- Command interface for velocity control -->
      <command_interface name="velocity">
        <param name="min">-10</param>
        <param name="max">10</param>
      </command_interface>
      <!-- State interfaces for position and velocity feedback -->
      <state_interface name="position" />
      <state_interface name="velocity" />
      <!-- <state_interface name="effort" /> -->
    </joint>
    
    <joint name="front_right_wheel_joint">
      <command_interface name="velocity">
        <param name="min">-10</param>
        <param name="max">10</param>
      </command_interface>
      <state_interface name="position" />
      <state_interface name="velocity" />
      <!-- <state_interface name="effort" /> -->
    </joint>

    <joint name="rear_left_wheel_joint">
      <command_interface name="velocity">
        <param name="min">-10</param>
        <param name="max">10</param>
      </command_interface>
      <state_interface name="position" />
      <state_interface name="velocity" />
      <!-- <state_interface name="effort" /> -->
    </joint>
    
    <joint name="front_left_wheel_joint">
      <command_interface name="velocity">
        <param name="min">-10</param>
        <param name="max">10</param>
      </command_interface>
      <state_interface name="position" />
      <state_interface name="velocity" />
      <!-- <state_interface name="effort" /> -->
    </joint>

  </ros2_control>


  <!-- <ros2_control name="new_robot" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/DefaultRobotHWSim</plugin>
    </hardware>

    <transmission name="front_left_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="front_left_wheel_joint" role="actuator">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </joint>
      <actuator name="front_left_motor">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </actuator>
      <plugin>gazebo_ros2_control/ActuatorPlugin</plugin>
    </transmission>

    <transmission name="front_right_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="front_right_wheel_joint" role="actuator">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </joint>
      <actuator name="front_right_motor">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </actuator>
      <plugin>gazebo_ros2_control/ActuatorPlugin</plugin>
    </transmission>

    <transmission name="rear_left_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="rear_left_wheel_joint" role="actuator">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </joint>
      <actuator name="rear_left_motor">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </actuator>
      <plugin>gazebo_ros2_control/ActuatorPlugin</plugin>
    </transmission>

    <transmission name="rear_right_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="rear_right_wheel_joint" role="actuator">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </joint>
      <actuator name="rear_right_motor">
        <hardwareInterface>hardware_interface/VelocityCommandInterface</hardwareInterface>
      </actuator>
      <plugin>gazebo_ros2_control/ActuatorPlugin</plugin>
    </transmission>
  </ros2_control> -->
  
  <!-- ================== Gazebo Plugins ================== -->
  <gazebo>
  
    <plugin name="ros2_control" filename="libgazebo_ros2_control.so">
      <robotNamespace>/</robotNamespace>
      <parameters>$(find mec)/config/driver.yaml</parameters>
    </plugin>

    <!-- <plugin filename="gz_ros2_control-system" name="gz_ros2_control::GazeboSimROS2ControlPlugin">
      <robotNamespace>/</robotNamespace>
      <parameters>$(find mec)/config/driver.yaml</parameters>
    </plugin> -->

    <!-- Encoders noise plugins -->
    <!-- <plugin name="encoder_noise_fl" filename="libgazebo_ros_joint_state_publisher.so">
      <jointName>front_left_wheel_joint</jointName>
      <gaussianNoise>
        <velocityNoise>0.02</velocityNoise>
        <positionNoise>0.003</positionNoise>
      </gaussianNoise>
    </plugin>

    <plugin name="encoder_noise_fr" filename="libgazebo_ros_joint_state_publisher.so">
      <jointName>front_right_wheel_joint</jointName>
      <gaussianNoise>
        <velocityNoise>0.015</velocityNoise>
        <positionNoise>0.002</positionNoise>
      </gaussianNoise>
    </plugin>

    <plugin name="encoder_noise_rl" filename="libgazebo_ros_joint_state_publisher.so">
      <jointName>rear_left_wheel_joint</jointName>
      <gaussianNoise>
        <velocityNoise>0.025</velocityNoise>
        <positionNoise>0.004</positionNoise>
      </gaussianNoise>
    </plugin>

    <plugin name="encoder_noise_rr" filename="libgazebo_ros_joint_state_publisher.so">
      <jointName>rear_right_wheel_joint</jointName>
      <gaussianNoise>
        <velocityNoise>0.018</velocityNoise>
        <positionNoise>0.0025</positionNoise>
      </gaussianNoise>
    </plugin> -->
  </gazebo>

</robot>
